<div id="wrapper">
	<div class="row">
		<div class="col-xs-1"></div>
		<div class="col-xs-10">
		<h3 class="heading">注文履歴詳細</h3>
			<div class="container">
				<div class="row">
					<div class="col-xs-7">
				    <p><strong>購入者</strong>　<%= @order.name %></p>
				    <p><strong>配送先</strong>　<%= @order.address %></p>
				    <p><strong>支払方法</strong>　<%= @order.payment_method %></p>
				    <p><strong>注文ステータス</strong>　<%= form_with(model: @order, url:{action: 'update'}, local: true) do |form| %></p>
				    <p><%= form.select :order_status, Order.order_statuses.keys %><%= form.submit '更新' %></p>
					<% end %>
					<table class="table table-borderd">
						<thead>
							<tr>
								<th>商品名</th>
								<th>単価(税込)</th>
								<th>数量</th>
								<th>小計</th>
								<th>製作ステータス</th>
							</tr>
						</thead>
						<tbody>
							<% sum_all = 0 %>
							<% @order.order_items.each do |order| %>
							<tr>
								<td><%= order.item.name %></td>
								<td><%= price_include_tax(order.item.price) %></td>
								<td><%= order.amount %></td>
								<td>
									<%= sub_total = price_include_tax(order.item.price).to_i * order.amount %>
									<% sum_all += sub_total.to_i %>
								</td>
								<%= form_with model: order, url: admins_order_item_path(order), method: :patch, local: true do |f| %>
								<td>
									<%= f.select :making_status, OrderItem.making_statuses.keys.map {|k| [k, k]} %>
									<%= f.submit '更新' %></td>
								</td>
								<% end %>
							</tr>
							<% end %>
						</tbody>
					</table>
					</div>
					<div class="col-xs-5">
						<table class="table table-borderd">
						<tr>
						    <th>商品合計</th>
						    <td><%= sum_all %>円</td>
						</tr>
						<tr>
						    <th>送料</th>
						    <td><%= @order.deliver_charge %>円</td>
						</tr>
						<tr>
							<th>請求金額合計</th>
						    <td><%= sum_all + @order.deliver_charge %>円</td>
						</tr>
						</table>
					</div>
			</div>
		</div>
		<div class="col-xs-1"></div>
	</div>
</div>